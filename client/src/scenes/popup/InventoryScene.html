<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Inventory Scene (CDN JS Demo)</title>
    <style>
      /* ÏµúÏÜå Ïä§ÌÉÄÏùº - TailwindÎ•º ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÎäî ÌôòÍ≤ΩÏùÑ ÏúÑÌï¥ Í∞ÑÎã®ÌïòÍ≤å ÎßåÎì≠ÎãàÎã§. */
      body {
        background: #0f1724;
        color: #e6eef8;
        font-family: Inter, system-ui, -apple-system, Roboto, "Helvetica Neue",
          Arial;
        margin: 0;
        padding: 20px;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
      }
      .card {
        background: #1a1d2e;
        border-radius: 12px;
        padding: 16px;
        border: 1px solid rgba(255, 255, 255, 0.06);
      }
      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 16px;
      }
      .left {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .title {
        font-size: 18px;
        font-weight: 600;
      }
      .btn {
        padding: 8px 14px;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: #e6eef8;
        cursor: pointer;
        font-size: 14px;
        height: 40px;
      }
      .btn.active {
        background: linear-gradient(90deg, #3b82f6, #2563eb);
        box-shadow: 0 0 24px rgba(168, 85, 247, 0.2);
      }
      .btn.filter {
        padding: 6px 12px;
        font-size: 13px;
      }
      .btn.filter.active {
        background: #4ea8de;
        box-shadow: none;
      }
      .search {
        position: relative;
      }
      .search input {
        padding: 10px 12px 10px 36px;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.03);
        color: inherit;
        border: 1px solid rgba(255, 255, 255, 0.06);
        height: 40px; /* match filter/button height */
        box-sizing: border-box;
      }
      .search .icon {
        position: absolute;
        left: 10px;
        top: 50%;
        transform: translateY(-50%);
      }
      .gold-display {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background: #2a2d3e;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.06);
      }
      .stats-summary {
        background: #252838;
        border-radius: 12px;
        padding: 16px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        margin-bottom: 16px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
      }
      .stats-summary > div {
        display: flex;
        flex-direction: column;
        height: 98.2%;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 8px;
        flex: 1;
      }
      .stat-box {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 8px;
      }
      .stat-box-label {
        font-size: 12px;
        color: #9aa3b2;
        min-width: 50px;
      }
      .stat-box-value {
        font-size: 20px;
        font-weight: 600;
        flex: 1;
        text-align: center;
      }
      .item-card {
        background: #252838;
        border-radius: 12px;
        padding: 16px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        margin-bottom: 12px;
        transition: all 0.2s;
      }
      .item-card:hover {
        border-color: rgba(255, 215, 0, 0.3);
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.1);
      }
      .item-card.equipped {
        border-color: #ffd700;
        background: rgba(255, 215, 0, 0.05);
      }
      .item-content {
        display: grid;
        grid-template-columns: 1fr 150px;
        gap: 16px;
        align-items: center;
      }
      .item-name {
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 6px;
      }
      .item-type {
        font-size: 12px;
        color: #9aa3b2;
      }
      .stat-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        margin-right: 6px;
      }
      .stat-badge.hp {
        background: rgba(255, 107, 107, 0.15);
        border: 1px solid rgba(255, 107, 107, 0.3);
        color: #ff6b6b;
      }
      .stat-badge.def {
        background: rgba(78, 168, 222, 0.15);
        border: 1px solid rgba(78, 168, 222, 0.3);
        color: #4ea8de;
      }
      .stat-badge.atk {
        background: rgba(168, 85, 247, 0.15);
        border: 1px solid rgba(168, 85, 247, 0.3);
        color: #a855f7;
      }
      .equipped-badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 11px;
        font-weight: 600;
        background: #ffd700;
        color: #000;
        margin-left: 8px;
      }
      .rarity-badge {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
      }
      .rarity-legendary {
        background: rgba(255, 215, 0, 0.15);
        border: 1px solid rgba(255, 215, 0, 0.3);
        color: #ffd700;
      }
      .rarity-epic {
        background: rgba(168, 85, 247, 0.15);
        border: 1px solid rgba(168, 85, 247, 0.3);
        color: #a855f7;
      }
      .rarity-rare {
        background: rgba(78, 168, 222, 0.15);
        border: 1px solid rgba(78, 168, 222, 0.3);
        color: #4ea8de;
      }
      .rarity-common {
        background: rgba(155, 163, 178, 0.15);
        border: 1px solid rgba(155, 163, 178, 0.3);
        color: #9aa3b2;
      }
      .action-btn {
        padding: 8px 16px;
        border-radius: 8px;
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 13px;
      }
      .action-btn.equip {
        background: linear-gradient(90deg, #3b82f6, #2563eb);
        color: #e6eef8;
      }
      .action-btn.equip:hover {
        background: linear-gradient(90deg, #3b82f6, #2563eb);
        color: #e6eef8;
        transform: scale(1.05);
      }
      .action-btn.unequip {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: #e6eef8;
      }
      .action-btn.unequip:hover {
        background: rgba(255, 255, 255, 0.06);
      }
      .action-btn.sell {
        background: rgba(255, 107, 107, 0.15);
        border: 1px solid rgba(255, 107, 107, 0.3);
        color: #ff6b6b;
      }
      .action-btn.sell:hover {
        background: rgba(255, 107, 107, 0.25);
      }
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #9aa3b2;
      }
      .equipment-slot {
        padding: 10px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 8px;
        margin-bottom: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 1px solid rgba(255, 255, 255, 0.06);
      }
      .equipment-slot.equipped {
        border-color: rgba(255, 215, 0, 0.3);
        background: rgba(255, 215, 0, 0.05);
      }
      .equipment-slot-label {
        font-size: 12px;
        color: #9aa3b2;
      }
      .equipment-slot-name {
        font-size: 13px;
        color: #e6eef8;
      }
      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.75);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        backdrop-filter: blur(4px);
      }
      .modal-content {
        background: #1a1d2e;
        border-radius: 12px;
        padding: 24px;
        border: 1px solid rgba(255, 215, 0, 0.3);
        max-width: 450px;
        width: 100%;
        box-shadow: 0 0 40px rgba(255, 215, 0, 0.15);
      }
      .modal-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 20px;
        padding-bottom: 16px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      }
      .modal-title {
        font-size: 18px;
        font-weight: 600;
        flex: 1;
      }
      .modal-body {
        margin-bottom: 20px;
      }
      .modal-item-info {
        background: #252838;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 16px;
        border: 1px solid rgba(255, 255, 255, 0.06);
      }
      .modal-item-name {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 8px;
      }
      .modal-label {
        font-size: 13px;
        color: #9aa3b2;
        margin-bottom: 8px;
      }
      .modal-input {
        width: 100%;
        padding: 12px 16px;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: #e6eef8;
        font-size: 16px;
        box-sizing: border-box;
        transition: all 0.2s;
      }
      .modal-input:focus {
        outline: none;
        border-color: rgba(255, 215, 0, 0.5);
        background: rgba(255, 255, 255, 0.05);
      }
      .modal-footer {
        display: flex;
        gap: 8px;
      }
      .modal-btn {
        flex: 1;
        padding: 12px;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        font-size: 14px;
        border: none;
        transition: all 0.2s;
      }
      .modal-btn.primary {
        background: linear-gradient(to right, #ffd700, #ffa500);
        color: #000;
      }
      .modal-btn.primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
      }
      .modal-btn.secondary {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: #e6eef8;
      }
      .modal-btn.secondary:hover {
        background: rgba(255, 255, 255, 0.06);
      }
      .notyf__toast {
        padding: 0px 20px !important; /* Í∏∞Î≥∏ 16px ‚Üí Îçî ÏûëÍ≤å */
        border-radius: 6px !important; /* Î™®ÏÑúÎ¶¨ Îë•Í∑º Ï†ïÎèÑ */
        width: auto !important; /* ÏûêÎèô ÎÑàÎπÑ */
        max-width: 500px !important; /* ÏµúÎåÄ ÎÑàÎπÑ ÎäòÎ¶¨Í∏∞ */
        max-height: 100vh !important; /* ÎÜíÏù¥ ÏµúÎåÄÎ°ú */
        display: inline-block !important; /* Í∞ÄÎ°úÎ°ú ÎäòÏñ¥ÎÇòÍ≤å */
        box-shadow: none !important; /* Í∑∏Î¶ºÏûê ÏÇ≠Ï†ú */
      }
      .notyf__message {
        font-size: 15px !important; /* Í∏ÄÏî® ÌÅ¨Í∏∞ Ï§ÑÏù¥Í∏∞ */
        line-height: 1.2 !important;
        display: block !important;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="root"></div>
    </div>

    <script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6/dist/tippy-bundle.umd.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/notyf/notyf.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/notyf/notyf.min.js"></script>
    <!-- React & ReactDOM (UMD builds) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel (in-browser JSX transpile for demo) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Demo: InventoryScene converted from TSX -> JS (JSX) for CDN usage -->
    <script type="text/babel">
      const { useState, useEffect } = React;
      const notyf = new Notyf({ ripple: false });

      function SellModal({ item, onClose, onConfirm }) {
        const [sellPrice, setSellPrice] = useState(item.sellPrice || "");

        const handleSubmit = () => {
          if (sellPrice && sellPrice > 0) {
            onConfirm(item, sellPrice);
            onClose();
          }
        };

        return (
          <div className="modal-overlay" onClick={onClose}>
            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
              <div className="modal-header">
                <div
                  style={{
                    width: 32,
                    height: 32,
                    background: "linear-gradient(135deg, #ffd700, #ffa500)",
                    borderRadius: 6,
                    display: "flex",
                    alignItems: "center",
                    justifyContent: "center",
                  }}
                >
                  üí∞
                </div>
                <div className="modal-title">ÏïÑÏù¥ÌÖú ÌåêÎß§</div>
              </div>

              <div className="modal-body">
                <div className="modal-item-info">
                  <div className="modal-item-name">{item.name}</div>
                  <div style={{ fontSize: 12, color: "#9aa3b2" }}>
                    {item.description}
                  </div>
                </div>

                <div className="modal-label">ÌåêÎß§ Í∏àÏï°</div>
                <input
                  type="number"
                  className="modal-input"
                  placeholder="ÌåêÎß§ Í∏àÏï°ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                  value={sellPrice}
                  onChange={(e) => setSellPrice(e.target.value)}
                  min="1"
                />
              </div>

              <div className="modal-footer">
                <button className="modal-btn secondary" onClick={onClose}>
                  Ï∑®ÏÜå
                </button>
                <button
                  className="modal-btn primary"
                  onClick={handleSubmit}
                  disabled={!sellPrice || sellPrice <= 0}
                >
                  Îì±Î°ù
                </button>
              </div>
            </div>
          </div>
        );
      }

      function InventoryScene({ onNavigate }) {
        const [activeFilter, setActiveFilter] = useState("all");
        const [searchQuery, setSearchQuery] = useState("");
        const [sellModalItem, setSellModalItem] = useState(null);

        const [inventoryItems, setInventoryItems] = useState([]);
        const [playerStats, setPlayerStats] = useState({});
        const [myGold, setMyGold] = useState(0);

        useEffect(() => {
          tippy("#enforce-hp-btn", {
            content: `
      <span style="display: flex; align-items: center; gap: 6px;">
        <img src="/assets/icons/coins.png" width="16" height="16" style="vertical-align: middle;" />
        ${playerStats.totalHp ? playerStats.totalHp * 10 : 0}
      </span>
    `,
            allowHTML: true,
          });
          tippy("#enforce-atk-btn", {
            content: `
      <span style="display: flex; align-items: center; gap: 6px;">
        <img src="/assets/icons/coins.png" width="16" height="16" style="vertical-align: middle;" />
        ${playerStats.totalAtk ? playerStats.totalAtk * 10 : 0}
      </span>
    `,
            allowHTML: true,
          });
          tippy("#enforce-def-btn", {
            content: `
      <span style="display: flex; align-items: center; gap: 6px;">
        <img src="/assets/icons/coins.png" width="16" height="16" style="vertical-align: middle;" />
        ${playerStats.totalDef ? playerStats.totalDef * 10 : 0}
      </span>
    `,
            allowHTML: true,
          });
        }, [playerStats]);

        // ‚≠ê Î∂ÄÎ™® ‚Üí iframe Î©îÏãúÏßÄ ÏàòÏã†
        useEffect(() => {
          window.parent.postMessage("INVENTORY_READY", "*");
          const handler = (event) => {
            if (event.data?.type === "INVENTORY_DATA") {
              setInventoryItems(event.data.payload.inventoryItems); // UI ÏóÖÎç∞Ïù¥Ìä∏
              setPlayerStats(event.data.payload.playerStats); // UI ÏóÖÎç∞Ïù¥Ìä∏
              setMyGold(event.data.payload.myGold); // UI ÏóÖÎç∞Ïù¥Ìä∏
              window.parent.postMessage("INVENTORY_RENDER_COMPLETE", "*");
            }
          };
          window.addEventListener("message", handler);

          return () => window.removeEventListener("message", handler);
        }, []);

        // const inventoryItems = [
        //   {
        //     id: 1,
        //     name: "ÌôîÏóºÏùò Í≤Ä",
        //     type: "weapon",
        //     atk: 65,
        //     equipped: true,
        //     description: "Î∂àÍΩÉÏúºÎ°ú Ï†ÅÏùÑ Î∂àÌÉúÏö∞Îäî Ï†ÑÏÑ§Ïùò Í≤Ä",
        //   },
        //   {
        //     id: 2,
        //     name: "Îã§Ïù¥ÏïÑÎ™¨Îìú Í∞ëÏò∑",
        //     type: "armor",
        //     def: 80,
        //     rarity: "legendary",
        //     equipped: true,
        //     description: "ÏµúÍ≥†Í∏â Îã§Ïù¥ÏïÑÎ™¨ÎìúÎ°ú ÎßåÎì† Í∞ëÏò∑",
        //     sellPrice: 4000,
        //   },
        //   {
        //     id: 3,
        //     name: "Ï≤¥Î†• Ìè¨ÏÖò",
        //     type: "consumable",
        //     hp: 50,
        //     quantity: 12,
        //     rarity: "common",
        //     description: "HPÎ•º 50 ÌöåÎ≥µÏãúÌÇ®Îã§",
        //     sellPrice: 50,
        //   },
        //   {
        //     id: 4,
        //     name: "Î≤àÍ∞ú Î∞òÏßÄ",
        //     type: "accessory",
        //     atk: 25,
        //     rarity: "epic",
        //     equipped: false,
        //     description: "Î≤àÍ∞úÏùò ÌûòÏù¥ ÍπÉÎì† Î∞òÏßÄ",
        //     sellPrice: 1500,
        //   },
        //   {
        //     id: 5,
        //     name: "ÎßàÎÇò Ìè¨ÏÖò",
        //     type: "consumable",
        //     mp: 30,
        //     quantity: 8,
        //     rarity: "common",
        //     description: "MPÎ•º 30 ÌöåÎ≥µÏãúÌÇ®Îã§",
        //     sellPrice: 40,
        //   },
        //   {
        //     id: 6,
        //     name: "ÏïîÏÇ¥ÏûêÏùò Îã®Í≤Ä",
        //     type: "weapon",
        //     atk: 45,
        //     rarity: "rare",
        //     equipped: false,
        //     description: "Îπ†Î•∏ Í≥µÍ≤©Ïóê ÌäπÌôîÎêú Îã®Í≤Ä",
        //     sellPrice: 1200,
        //   },
        //   {
        //     id: 7,
        //     name: "Í∞ÄÏ£Ω Ïû•Í∞ë",
        //     type: "armor",
        //     def: 15,
        //     rarity: "common",
        //     equipped: false,
        //     description: "Í∏∞Î≥∏Ï†ÅÏù∏ Î∞©Ïñ¥Î†•ÏùÑ Ï†úÍ≥µ",
        //     sellPrice: 300,
        //   },
        //   {
        //     id: 8,
        //     name: "Ìô©Í∏à Î™©Í±∏Ïù¥",
        //     type: "accessory",
        //     hp: 30,
        //     rarity: "rare",
        //     equipped: true,
        //     description: "ÏµúÎåÄ Ï≤¥Î†•ÏùÑ Ï¶ùÍ∞ÄÏãúÌÇ®Îã§",
        //     sellPrice: 800,
        //   },
        // ];

        // const playerStats = {
        //   totalAtk: 135,
        //   totalDef: 95,
        //   totalHp: 250,
        // };

        const filterItems = () => {
          let items = inventoryItems;

          // Filter by type
          if (activeFilter !== "all") {
            items = items.filter((i) => i.type === activeFilter);
          }

          // Filter by search
          if (searchQuery) {
            items = items.filter((i) =>
              i.name.toLowerCase().includes(searchQuery.toLowerCase())
            );
          }

          return items;
        };

        const filteredItems = filterItems();

        const getRarityClass = (rarity) => {
          return `rarity-${rarity}`;
        };

        const getTypeLabel = (type) => {
          switch (type) {
            case "hat":
              return "Î™®Ïûê";
            case "top":
              return "ÏÉÅÏùò";
            case "bottom":
              return "ÌïòÏùò";
            case "shoes":
              return "Ïã†Î∞ú";
            case "gloves":
              return "Ïû•Í∞ë";
            case "weapon":
              return "Î¨¥Í∏∞";
            default:
              return type;
          }
        };

        const handleEquip = (item) => {
          setInventoryItems((prev) =>
            prev.map((i) =>
              i.id === item.id
                ? { ...i, equipped: true }
                : i.type === item.type
                ? { ...i, equipped: false }
                : i
            )
          );
        };

        return (
          <div className="card">
            <div className="header">
              <div className="left">
                <img
                  src="/assets/icons/inventory_icon.png"
                  alt="Ïù∏Î≤§ÌÜ†Î¶¨ ÏïÑÏù¥ÏΩò"
                  style={{
                    width: 18,
                    height: 18,
                  }}
                />
                <div className="title">Ïù∏Î≤§ÌÜ†Î¶¨</div>
              </div>
              <button
                className="btn"
                onClick={() => {
                  const iframe =
                    window.parent.document.getElementById("react-ui");
                  iframe.src = "about:blank"; // ÏôÑÏ†Ñ Ï¥àÍ∏∞Ìôî
                  iframe.style.visibility = "hidden";
                }}
              >
                Îã´Í∏∞
              </button>
            </div>

            {/* Stats Summary */}
            <div className="stats-summary">
              {/* Left: Îä•Î†•Ïπò */}
              <div>
                <div
                  style={{ marginBottom: 12, color: "#9aa3b2", fontSize: 13 }}
                >
                  ÌòÑÏû¨ Îä•Î†•Ïπò
                </div>
                <div className="stats-grid">
                  <div className="stat-box">
                    <div className="stat-box-label">Ï≤¥Î†•</div>
                    <div
                      className="stat-box-value"
                      style={{ color: "#ff6b6b" }}
                    >
                      {playerStats.totalHp}
                    </div>
                    <button
                      id="enforce-hp-btn"
                      className="btn"
                      style={{ height: 30, fontSize: 12, marginTop: 0 }}
                      onClick={() => {
                        const cost = playerStats.totalHp * 10;
                        if (myGold < cost) {
                          notyf.error("Í≥®ÎìúÍ∞Ä Î∂ÄÏ°±ÌïòÏó¨ Í∞ïÌôîÌï† Ïàò ÏóÜÏäµÎãàÎã§.");
                          return;
                        }
                        notyf.success("Ï≤¥Î†• Í∞ïÌôî ÏôÑÎ£å!");
                        setMyGold((prev) => prev - cost);
                        setPlayerStats((prev) => ({
                          ...prev,
                          totalHp: prev.totalHp + 1,
                        }));
                      }}
                    >
                      Í∞ïÌôî
                    </button>
                  </div>
                  <div className="stat-box">
                    <div className="stat-box-label">Í≥µÍ≤©Î†•</div>
                    <div
                      className="stat-box-value"
                      style={{ color: "#a855f7" }}
                    >
                      {playerStats.totalAtk}
                    </div>
                    <button
                      id="enforce-atk-btn"
                      className="btn"
                      style={{ height: 30, fontSize: 12, marginTop: 0 }}
                      onClick={() => {
                        const cost = playerStats.totalAtk * 10;
                        if (myGold < cost) {
                          notyf.error("Í≥®ÎìúÍ∞Ä Î∂ÄÏ°±ÌïòÏó¨ Í∞ïÌôîÌï† Ïàò ÏóÜÏäµÎãàÎã§.");
                          return;
                        }
                        notyf.success("Í≥µÍ≤©Î†• Í∞ïÌôî ÏôÑÎ£å!");
                        setMyGold((prev) => prev - cost);
                        setPlayerStats((prev) => ({
                          ...prev,
                          totalAtk: prev.totalAtk + 1,
                        }));
                      }}
                    >
                      Í∞ïÌôî
                    </button>
                  </div>
                  <div className="stat-box">
                    <div className="stat-box-label">Î∞©Ïñ¥Î†•</div>
                    <div
                      className="stat-box-value"
                      style={{ color: "#4ea8de" }}
                    >
                      {playerStats.totalDef}
                    </div>
                    <button
                      id="enforce-def-btn"
                      className="btn"
                      style={{ height: 30, fontSize: 12, marginTop: 0 }}
                      onClick={() => {
                        const cost = playerStats.totalDef * 10;
                        if (myGold < cost) {
                          notyf.error("Í≥®ÎìúÍ∞Ä Î∂ÄÏ°±ÌïòÏó¨ Í∞ïÌôîÌï† Ïàò ÏóÜÏäµÎãàÎã§.");
                          return;
                        }
                        notyf.success("Î∞©Ïñ¥Î†• Í∞ïÌôî ÏôÑÎ£å!");
                        setMyGold((prev) => prev - cost);
                        setPlayerStats((prev) => ({
                          ...prev,
                          totalDef: prev.totalDef + 1,
                        }));
                      }}
                    >
                      Í∞ïÌôî
                    </button>
                  </div>

                  {/* Î≥¥Ïú† Í≥®Îìú */}
                  <div className="stat-box">
                    <div className="stat-box-label">Î≥¥Ïú†Í≥®Îìú</div>
                    <div
                      className="stat-box-value"
                      style={{ color: "#ffd700" }}
                    >
                      <img
                        src="/assets/icons/coins.png"
                        alt="Gold"
                        width="20"
                        height="20"
                        style={{ verticalAlign: "middle" }}
                      />{" "}
                      {myGold}G
                    </div>
                    <div style={{ width: 60 }}></div>
                  </div>
                </div>
              </div>

              {/* Right: Ï∞©Ïö© Ïû•ÎπÑ */}
              <div>
                <div
                  style={{ marginBottom: 12, color: "#9aa3b2", fontSize: 13 }}
                >
                  Ï∞©Ïö© Ïû•ÎπÑ
                </div>
                <div>
                  {["Î™®Ïûê", "ÏÉÅÏùò", "ÌïòÏùò", "Ïã†Î∞ú", "Ïû•Í∞ë", "Î¨¥Í∏∞"].map(
                    (slot) => {
                      const equippedItem = inventoryItems.find(
                        (i) => i.equipped && getTypeLabel(i.type) === slot
                      );
                      return (
                        <div
                          className={
                            "equipment-slot" + (equippedItem ? " equipped" : "")
                          }
                          key={slot}
                        >
                          <div className="equipment-slot-label">{slot}</div>
                          <div
                            className="equipment-slot-name"
                            style={{
                              color: equippedItem ? "#e6eef8" : "#666",
                            }}
                          >
                            {equippedItem ? equippedItem.name : "ÎπÑÏñ¥ÏûàÏùå"}
                          </div>
                        </div>
                      );
                    }
                  )}
                </div>
              </div>
            </div>

            {/* Tabs and Controls - single row */}
            <div
              style={{
                display: "flex",
                justifyContent: "space-between",
                alignItems: "center",
                marginBottom: 8,
              }}
            >
              <div style={{ color: "#9aa3b2", fontSize: 14, marginLeft: 4 }}>
                ÏÜåÏú†ÌïòÍ≥† ÏûàÎäî ÏïÑÏù¥ÌÖú
              </div>

              <div style={{ display: "flex", gap: 8, alignItems: "center" }}>
                <button
                  className={
                    "btn filter" + (activeFilter === "all" ? " active" : "")
                  }
                  onClick={() => setActiveFilter("all")}
                >
                  Ï†ÑÏ≤¥
                </button>
                <button
                  className={
                    "btn filter" + (activeFilter === "hat" ? " active" : "")
                  }
                  onClick={() => setActiveFilter("hat")}
                >
                  Î™®Ïûê
                </button>
                <button
                  className={
                    "btn filter" + (activeFilter === "top" ? " active" : "")
                  }
                  onClick={() => setActiveFilter("top")}
                >
                  ÏÉÅÏùò
                </button>
                <button
                  className={
                    "btn filter" + (activeFilter === "bottom" ? " active" : "")
                  }
                  onClick={() => setActiveFilter("bottom")}
                >
                  ÌïòÏùò
                </button>
                <button
                  className={
                    "btn filter" + (activeFilter === "shoe" ? " active" : "")
                  }
                  onClick={() => setActiveFilter("shoes")}
                >
                  Ïã†Î∞ú
                </button>
                <button
                  className={
                    "btn filter" + (activeFilter === "glove" ? " active" : "")
                  }
                  onClick={() => setActiveFilter("glove")}
                >
                  Ïû•Í∞ë
                </button>
                <button
                  className={
                    "btn filter" + (activeFilter === "weapon" ? " active" : "")
                  }
                  onClick={() => setActiveFilter("weapon")}
                >
                  Î¨¥Í∏∞
                </button>

                <div className="search">
                  <span className="icon">üîç</span>
                  <input
                    placeholder="ÏïÑÏù¥ÌÖú Í≤ÄÏÉâ..."
                    value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                  />
                </div>
              </div>
            </div>

            {/* Items List */}
            <div style={{ marginTop: 12 }}>
              {filteredItems.length > 0 ? (
                filteredItems.map((item) => (
                  <div
                    key={item.id}
                    className={"item-card" + (item.equipped ? " equipped" : "")}
                  >
                    <div className="item-content">
                      <div>
                        <div className="item-name">
                          <span style={{ marginRight: 10 }}>{item.name}</span>
                          {item.hp && (
                            <span className="stat-badge hp">+{item.hp} HP</span>
                          )}
                          {item.atk && (
                            <span className="stat-badge atk">
                              +{item.atk} ATK
                            </span>
                          )}
                          {item.def && (
                            <span className="stat-badge def">
                              +{item.def} DEF
                            </span>
                          )}
                          {item.equipped && (
                            <span className="equipped-badge">Ïû•Ï∞©Ï§ë</span>
                          )}
                        </div>
                        <div>
                          <span className="item-type">
                            {getTypeLabel(item.type)}
                          </span>
                        </div>
                      </div>
                      <div style={{ display: "flex", gap: 6 }}>
                        {item.type === "consumable" ? (
                          <button className="action-btn equip">ÏÇ¨Ïö©</button>
                        ) : item.equipped ? (
                          // Ïû•Ï∞©Ï§ëÏùº Îïå: Ìï¥Ï†ú Î≤ÑÌäºÎßå ÌëúÏãú (ÌåêÎß§ Î≤ÑÌäº ÏóÜÏùå)
                          <button
                            className="action-btn unequip"
                            style={{ width: "118px" }} // ÌåêÎß§ Î≤ÑÌäº ÏúÑÏπòÎ°ú Ïò§ÎèÑÎ°ù ÎÑìÍ≤å
                            onClick={() =>
                              setInventoryItems((prev) =>
                                prev.map((i) =>
                                  i.id === item.id
                                    ? { ...i, equipped: false }
                                    : i
                                )
                              )
                            }
                          >
                            Ìï¥Ï†ú
                          </button>
                        ) : (
                          // Ïû•Ï∞© ÏïàÎêú ÏÉÅÌÉú: Ïû•Ï∞© + ÌåêÎß§ Î≤ÑÌäº
                          <>
                            <button
                              className="action-btn equip"
                              onClick={() => {
                                handleEquip(item);
                                setSellModalItem(null);
                              }}
                            >
                              Ïû•Ï∞©
                            </button>
                            <button
                              className="action-btn sell"
                              onClick={() => setSellModalItem(item)}
                            >
                              ÌåêÎß§
                            </button>
                          </>
                        )}
                      </div>
                    </div>
                  </div>
                ))
              ) : (
                <div className="empty-state">
                  <img
                    src="/assets/icons/inventory_hide.png"
                    alt="Gold"
                    width="23"
                    height="23"
                    style={{ verticalAlign: "middle" }}
                  />
                  {"   "}
                  <span style={{ verticalAlign: "middle" }}>
                    ÏïÑÏù¥ÌÖúÏù¥ ÏóÜÏäµÎãàÎã§.
                  </span>
                </div>
              )}
            </div>

            {/* Sell Modal */}
            {sellModalItem && (
              <SellModal
                item={sellModalItem}
                onClose={() => setSellModalItem(null)}
                onConfirm={(item, price) => {
                  // ÏïÑÏù¥ÌÖú Ï†úÍ±∞
                  setInventoryItems((prev) =>
                    prev.filter((i) => i.id !== item.id)
                  );
                  setSellModalItem(null);
                  notyf.success(
                    `${item.name}Ïù¥(Í∞Ä) ${price}GÏóê Í±∞ÎûòÏÜåÏóê Îì±Î°ùÎêòÏóàÏäµÎãàÎã§.`
                  );
                }}
              />
            )}
          </div>
        );
      }

      // ÏòàÏãú Î†åÎçîÎßÅ: rootÏóê Î∂ôÏù¥Í∏∞
      ReactDOM.createRoot(document.getElementById("root")).render(
        React.createElement(InventoryScene, {
          onNavigate: (scene) => {
            console.log("navigate to", scene);
          },
        })
      );
    </script>
  </body>
</html>
